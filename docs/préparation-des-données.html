<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Préparation des données | Notes personnelles : Principes stats, procédures et outils avec R</title>
  <meta name="description" content="3 Préparation des données | Notes personnelles : Principes stats, procédures et outils avec R" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Préparation des données | Notes personnelles : Principes stats, procédures et outils avec R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Préparation des données | Notes personnelles : Principes stats, procédures et outils avec R" />
  
  
  

<meta name="author" content="Nicolas Bressoud" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="environnement-de-travail.html"/>
<link rel="next" href="description-des-données.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préambule</a></li>
<li class="chapter" data-level="2" data-path="environnement-de-travail.html"><a href="environnement-de-travail.html"><i class="fa fa-check"></i><b>2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="2.1" data-path="environnement-de-travail.html"><a href="environnement-de-travail.html#github-et-structure-des-dossiers-locaux"><i class="fa fa-check"></i><b>2.1</b> GitHub et structure des dossiers locaux</a></li>
<li class="chapter" data-level="2.2" data-path="environnement-de-travail.html"><a href="environnement-de-travail.html#rstudio-et-packages"><i class="fa fa-check"></i><b>2.2</b> RStudio et packages</a></li>
<li class="chapter" data-level="2.3" data-path="environnement-de-travail.html"><a href="environnement-de-travail.html#sublime-text-et-packages."><i class="fa fa-check"></i><b>2.3</b> Sublime Text et Packages.</a></li>
<li class="chapter" data-level="2.4" data-path="environnement-de-travail.html"><a href="environnement-de-travail.html#scrivener-3-zotero-betterbibtext---rédaction-darticles-longs"><i class="fa fa-check"></i><b>2.4</b> Scrivener 3 + Zotero + BetterBibText - Rédaction d’articles longs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="préparation-des-données.html"><a href="préparation-des-données.html"><i class="fa fa-check"></i><b>3</b> Préparation des données</a>
<ul>
<li class="chapter" data-level="3.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#bonnes-pratiques-dans-le-système-de-récolte-des-données-qualtrics"><i class="fa fa-check"></i><b>3.1</b> Bonnes pratiques dans le système de récolte des données (Qualtrics, …)</a></li>
<li class="chapter" data-level="3.2" data-path="préparation-des-données.html"><a href="préparation-des-données.html#premières-étapes-dans-r-en-principe-les-noms-des-variables-sont-sains"><i class="fa fa-check"></i><b>3.2</b> Premières étapes dans R (en principe, les noms des variables sont sains)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#ajout-de-la-variable-de-temps-dans-chaque-df"><i class="fa fa-check"></i><b>3.2.1</b> ajout de la variable de temps dans chaque df</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="description-des-données.html"><a href="description-des-données.html"><i class="fa fa-check"></i><b>4</b> Description des données</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="description-des-données.html"><a href="description-des-données.html#obtenir-une-synthèse-de-données"><i class="fa fa-check"></i><b>4.0.1</b> Obtenir une synthèse de données</a></li>
<li class="chapter" data-level="4.1" data-path="description-des-données.html"><a href="description-des-données.html#princpes"><i class="fa fa-check"></i><b>4.1</b> Princpes</a></li>
<li class="chapter" data-level="4.2" data-path="description-des-données.html"><a href="description-des-données.html#procédures"><i class="fa fa-check"></i><b>4.2</b> Procédures</a></li>
<li class="chapter" data-level="4.3" data-path="description-des-données.html"><a href="description-des-données.html#tableaux"><i class="fa fa-check"></i><b>4.3</b> Tableaux</a></li>
<li class="chapter" data-level="4.4" data-path="description-des-données.html"><a href="description-des-données.html#plots"><i class="fa fa-check"></i><b>4.4</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rapport.html"><a href="rapport.html"><i class="fa fa-check"></i><b>5</b> Rapport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rapport.html"><a href="rapport.html#principes"><i class="fa fa-check"></i><b>5.1</b> Principes</a></li>
<li class="chapter" data-level="5.2" data-path="rapport.html"><a href="rapport.html#procédures-clés"><i class="fa fa-check"></i><b>5.2</b> Procédures clés</a></li>
<li class="chapter" data-level="5.3" data-path="rapport.html"><a href="rapport.html#un-mot-sur-les-normes-apa"><i class="fa fa-check"></i><b>5.3</b> Un mot sur les normes APA</a></li>
<li class="chapter" data-level="5.4" data-path="rapport.html"><a href="rapport.html#un-mot-sur-bookdown-et-github"><i class="fa fa-check"></i><b>5.4</b> Un mot sur Bookdown et GitHub</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes personnelles : Principes stats, procédures et outils avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="préparation-des-données" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Préparation des données</h1>
<p>Au sein de ce chapitre, on cherche à atteindre le double objectif de/d’ :</p>
<ul>
<li>expliciter une manière que l’on espère <em>élégante</em> et <em>efficace</em> <strong>(minimum d’effort pour le maximum d’efficacité)</strong> de préparer les données.</li>
<li>se conformer aux apprentissages et pratiques en traitement des données (et progresser).</li>
</ul>
<p>On cherche dans la mesure du possible à toujours travailler avec des <em>tidy datas</em> et à utiliser en priorité les fonctions de la série de packages de <code>tidyverse</code>.</p>
<div id="bonnes-pratiques-dans-le-système-de-récolte-des-données-qualtrics" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Bonnes pratiques dans le système de récolte des données (Qualtrics, …)</h2>
<p>Chaque participant·e reçoit un <em>id</em> partiellement anonymisé. Il est fourni par le chercheur (et n’est pas construit par le ou la participant·e). L’<em>id</em> ne contient que des chiffres pour simplifier le problème des majuscules/minuscules à la saisie et éviter les confusions entre le <em>zéro</em> et la lettre <em>o</em> (oui oui, c’est du vécu). Ceci signifie que l’<em>id</em> dispose d’une structure qui permet de/d’ :</p>
<ul>
<li>évaluer son authenticité</li>
<li>faciliter la catégorisation des données</li>
<li>repérer efficacement les <em>id</em> et leur catégorisation dans les traitement ultérieurs.</li>
</ul>
<p><strong>exemple : un <em>id</em> comme <em>12.47.694</em> est structuré comme suit <em>classe12.constantearbitraire47.nombrealéatoireà3chiffres</em>.</strong></p>
<p>Chaque <em>id</em> est <strong>vérifié</strong> dans Qualtrics, ce qui signifie qu’un·e participant·e doit confirmer l’<em>id</em> pour que le système passe à la suite. On relève aussi l’intérêt de demander à l’utilisateur·trice de <strong>confirmer son groupe d’appartenance</strong> en cochant un facteur dans une <strong>liste imposée</strong> dans Qualtrics. Ceci a l’avantage de repérer les saisies fantasques (une personne met un <em>id</em> bidon / un·e participant·e s’inscrit avec le bon <em>id</em> mais dans le mauvais groupe, …).
Dans la préparation des données, il semble que l’on gagne ainsi un temps important pour trier les données valables et que la confiance dans les données s’en trouve augmentée.
On relève toutefois une faiblesse : le code n’est pas 100% anonyme et on peut toujours remonter à un groupe de participant·es. Il faut alors en amont s’engager à détruire le document qui a permis la génération des <em>id</em>.</p>
<p>Chaque questionnaire est identifié par 3 premières lettre significatives, le nombre d’items et un <code>_</code>:</p>
<p><strong>exemple : Questionnaire sur la motivation scolaire en 13 items devient <code>mot13</code>.</strong></p>
<p>Ensuite, chacun des items est proprement nommé par ordre d’apparition :</p>
<p><strong>exemple : <code>mot13_1</code>, <code>mot13_2</code>, …, <code>mot13_13</code> (il semble que Qualtrics ajoute par défaut le <em>underscore_</em> )</strong></p>
</div>
<div id="premières-étapes-dans-r-en-principe-les-noms-des-variables-sont-sains" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Premières étapes dans R (en principe, les noms des variables sont sains)</h2>
<p>On commence par le chargement des packages et l’importation du ou des fichiers de données. Dans cet exemple, on prend le cas (plus complexe) où nous devons gérer et associer deux <code>data frames</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="préparation-des-données.html#cb3-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="préparation-des-données.html#cb3-2"></a><span class="kw">library</span>(readxl)</span>
<span id="cb3-3"><a href="préparation-des-données.html#cb3-3"></a></span>
<span id="cb3-4"><a href="préparation-des-données.html#cb3-4"></a><span class="co"># Importation des données Qualtrics à disposition ----</span></span>
<span id="cb3-5"><a href="préparation-des-données.html#cb3-5"></a>d_t1_raw &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;crips2019_lv_raw_t1.xlsx&quot;</span>)</span>
<span id="cb3-6"><a href="préparation-des-données.html#cb3-6"></a>d_t2_raw &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;crips2019_lv_raw_t2.xlsx&quot;</span>)</span></code></pre></div>
<div id="ajout-de-la-variable-de-temps-dans-chaque-df" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> ajout de la variable de temps dans chaque df</h3>
<p>Dans cet exemple, on règle en même temps le problème des <em>id</em> qui contiennent des majuscules.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="préparation-des-données.html#cb4-1"></a><span class="co">#Ajout de la variable temps sur chaque df et normalisation des id en minuscule.</span></span>
<span id="cb4-2"><a href="préparation-des-données.html#cb4-2"></a></span>
<span id="cb4-3"><a href="préparation-des-données.html#cb4-3"></a>d_t1 &lt;-<span class="st"> </span>d_t1_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="préparation-des-données.html#cb4-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">temps=</span><span class="st">&quot;temps 1&quot;</span>,</span>
<span id="cb4-5"><a href="préparation-des-données.html#cb4-5"></a>         <span class="dt">id=</span><span class="kw">tolower</span>(id)) </span>
<span id="cb4-6"><a href="préparation-des-données.html#cb4-6"></a></span>
<span id="cb4-7"><a href="préparation-des-données.html#cb4-7"></a>d_t2 &lt;-<span class="st"> </span>d_t2_raw <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-8"><a href="préparation-des-données.html#cb4-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">temps=</span><span class="st">&quot;temps 2&quot;</span>,</span>
<span id="cb4-9"><a href="préparation-des-données.html#cb4-9"></a>         <span class="dt">id=</span><span class="kw">tolower</span>(id))</span></code></pre></div>
<p>Les items à inverser sont traités en étant strictement remplacés via la fonction <code>mutate()</code> dans le cadre de l’enregistrement d’un nouveau <code>data frame</code>. R permet de remonter les changements donc cet écrasement n’empêche pas la vérification des processus, étape par étape.</p>
<p>Ce procédé d’écrasement facilite l’analyse de la cohérence interne ou le calcul des scores par la suite (cf. chapitre <em>description</em>).</p>
<p>La variable qui contient le score global de chaque questionnaire par participant·e porte l’extension sco :</p>
<p><strong>exemple : <code>mot13_sco</code> est la variable de score total de <code>mot13_1</code> à <code>mot13_13</code> avec les variables qui ont été inversées.</strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="environnement-de-travail.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="description-des-données.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/bresnico/learn/blob/master/02_preparation.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
